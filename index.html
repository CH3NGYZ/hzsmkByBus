<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>正在跳转...</title>
  <style>
    body { font-family: sans-serif; padding: 2em; text-align: center; }
    .loading { font-size: 1.2em; color: #444; }
    .error { color: red; }
  </style>
</head>
<body>
  <p class="loading">正在获取 token 并跳转，请稍候...</p>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
    function getQueryParam(key) {
      const url = new URL(window.location.href);
      return url.searchParams.get(key);
    }

    const channelToken = getQueryParam('channelToken');

    if (!channelToken) {
      document.querySelector('.loading').innerHTML = '<span class="error">❌ 缺少 channelToken 参数</span>';
    } else {
      axios.post(
        'https://talent.hzrcm.cn/smk_hztalent/front/app/home/getHzrckToken',
        {
          channelToken: channelToken,
          channel: 'smk_app'
        },
        {
          headers: {
            'Content-Type': 'application/json;charset=UTF-8',
            'sendClient': 'hellohzsmk',
            'sendChl': 'hzsmk.h5',
            'Origin': 'https://talent.hzrcm.cn',
            'X-Requested-With': 'com.smk',
            'Referer': 'https://talent.hzrcm.cn/exthtml/hangZhouTalentCard/index.html'
          }
        }
      )
      .then(res => {
        const token = res.data?.response?.hzrckToken;
        if (token) {
          const jumpUrl = `https://hzrck.hzzhdj.cn/exthtml/youngTalentCard/freeCoderide/#/byBus?token=${token}`;
          window.location.href = jumpUrl;
        } else {
          document.querySelector('.loading').innerHTML = '<span class="error">❌ 未获取到 hzrckToken</span>';
        }
      })
      .catch(error => {
        console.error(error);
        document.querySelector('.loading').innerHTML = '<span class="error">❌ 请求失败，请稍后重试</span>';
      });
    }
  </script>
</body>
</html>
